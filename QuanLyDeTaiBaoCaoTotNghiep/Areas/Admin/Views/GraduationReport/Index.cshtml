@using QuanLyDeTaiBaoCaoTotNghiep.Models;
@using PagedList.Mvc;
@model PagedList.PagedList<QuanLyDeTaiBaoCaoTotNghiep.Models.GraduationReport>

@{
    ViewBag.Title = "Create";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
</head>
<style>
    .img {
        border-radius: 10px;
        height: 110px;
        object-fit: cover;
        box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px, rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;
    }

    td {
        vertical-align: baseline;
        align-items: center;
    }

    th {
        font-weight: bolder;
    }

    p {
        width: 200px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }
</style>
@helper  Truncate(string s, int length)
{
    if (s.Length < length)
    {
        @s
    }
    else
    {
        @s.Substring(0, length)<text>...</text>
    }
}
<body>
    <p>
        @Html.ActionLink("Thêm mới", "Create", null, new { @class = "btn btn-success" })
    </p>
    <table class="table">
        <tr>
            <th>
                Tên báo cáo
            </th>
            <th>
                Hình ảnh
            </th>
            <th>
                Mô tả
            </th>
            @*<th>
                    @Html.DisplayNameFor(model => model.UserID)
                </th>*@
            @*<th>
                Tác giả
            </th>*@
            @*<th>
                    @Html.DisplayNameFor(model => model.CommentID)
                </th>*@
            @*<th>
                    @Html.DisplayNameFor(model => model.UrlFile)
                </th>*@
            @*<th>
                    @Html.DisplayNameFor(model => model.Keyword)
                </th>*@
            <th>
                Lớp
            </th>
            @*<th>
                    @Html.DisplayNameFor(model => model.Faculty.FacultyName)
                </th>*@
            <th>
                Niên khóa
            </th>
            <th></th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Truncate(item.GraduationReportName.ToUpper(), 20)

                </td>
                <td>

                    <img src="~/content/images/anhbaocao/@item.Image" style="width:70px" />
                </td>
                <td>
                    <p class="product-description" style="max-width: 150px; overflow: hidden; text-overflow: ellipsis; line-height: 25px; -webkit-line-clamp: 3; height: 75px; display: -webkit-box; -webkit-box-orient: vertical; ">@item.Description</p>
                    @*@Truncate(item.Description, 50)*@

                </td>
                @*<td>
                        @Html.DisplayFor(modelItem => item.UserID)
                    </td>*@
            @*<td>

                @Html.DisplayFor(modelItem => item.Author)
            </td>*@
                @*<td>
                        @Html.DisplayFor(modelItem => item.CommentID)
                    </td>*@
                @*<td>
                        @Html.DisplayFor(modelItem => item.UrlFile)
                    </td>*@
                @*<td>
                        @Html.DisplayFor(modelItem => item.Keyword)
                    </td>*@
                <td>
                    @Html.DisplayFor(modelItem => item.Class.ClassName)
                </td>
                @*<td>
                        @Html.DisplayFor(modelItem => item.Faculty.FacultyName)
                    </td>*@
                <td>
                    @Html.DisplayFor(modelItem => item.AcademicYear.Name)
                </td>
                @*<td>
                        <a href="/Admin/GraduationReport/Edit/@item.GraduationReportID"><i class="fa-solid fa-pen-to-square b"></i></a>
                        <a href="/Admin/GraduationReport/Details/@item.GraduationReportID"><i class="fa-solid fa-circle-info g"></i></a>
                        <a href="/Admin/GraduationReportID/Delete/@item.GraduationReportID" class="Delete"><i class="fa-solid fa-trash r"></i></a>


                    </td>*@

                <td>
                    @Html.ActionLink("Sửa", "Edit", new { id = item.GraduationReportID }, new { @class = "btn btn-primary" })

                    @Html.ActionLink("Chi tiết", "Details", new { id = item.GraduationReportID }, new { @class = "btn btn-info Delete" })
                    <a data-id="@item.GraduationReportID" class="btn btn-danger delete">Xóa</a>
                </td>
            </tr>
        }
    </table>
</body>
</html>



<div class="list">
    <div class="MenuTrang">
        @Html.PagedListPager(Model, page => Url.Action("Index", "GraduationReport", new { page = page }))
    </div>
</div>

<style>
    .MenuTrang {
        margin-top: 500px;
        display: inline;
        text-align: center;
        width: 100%;
    }
</style>


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    const btnDelete = document.querySelectorAll('.delete');

    btnDelete.forEach(btn => {
        btn.addEventListener('click', (event) => {
            var id = btn.dataset.id;
            event.preventDefault();

            Swal.fire({
                title: 'Bạn có chắc chắn muốn xóa ?',
                text: "Nếu bạn xóa bạn không thể khôi phục lại!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                cancelButtonText: 'Hủy',
                confirmButtonText: 'Xóa'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire(
                        'Xóa thành công'
                    )
                    window.location.href = "/GraduationReport/Delete/" + id;
                }
            })
        });
    });
</script>