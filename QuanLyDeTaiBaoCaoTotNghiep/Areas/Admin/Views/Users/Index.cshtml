@using QuanLyDeTaiBaoCaoTotNghiep.Models;
@using PagedList.Mvc;
@model PagedList.PagedList<QuanLyDeTaiBaoCaoTotNghiep.Models.Users>

@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}



<p>
    @Html.ActionLink("Thêm mới", "Create", null, new { @class = "btn btn-success" })
</p>
<table class="table">
    <tr>
        <th>
            Họ và tên
        </th>
        <th>
            Tuổi
        </th>
        <th>
            Địa chỉ
        </th>
        <th>
            Tên đăng nhập
        </th>
        @*<th>
                @Html.DisplayNameFor(model => model.PassWord)
            </th>*@
        @*<th>
                @Html.DisplayNameFor(model => model.Role)
            </th>*@
        <th>
            Email
        </th>
        @*<th>
                @Html.DisplayNameFor(model => model.Phone)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Date)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ResetPasswordCode)
            </th>*@
        <th>
            Tên lớp
        </th>
        <th>
            Tên khoa -  viện
        </th>
        <th>
            Niên khóa
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Age)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Address)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.UserName)
            </td>
            @*<td>
                    @Html.DisplayFor(modelItem => item.PassWord)
                </td>*@
            @*<td>
                    @Html.DisplayFor(modelItem => item.Role)
                </td>*@
            <td>
                @Html.DisplayFor(modelItem => item.Email)
            </td>
            @*<td>
                    @Html.DisplayFor(modelItem => item.Phone)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Date)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ResetPasswordCode)
                </td>*@
            <td>
                @Html.DisplayFor(modelItem => item.Class.ClassName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Faculty.FacultyName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.AcademicYear.Name)
            </td>
            <td>
                @Html.ActionLink("Sửa", "Edit", new { id = item.ID }, new { @class = "btn btn-primary" })
                @Html.ActionLink("Chi tiết", "Details", new { id = item.ID }, new { @class = "btn btn-info" })
                <a data-id="@item.ID" class="btn btn-danger delete">Xóa</a>
            </td>
        </tr>
    }

</table>

<div class="list">
    <div class="MenuTrang">
        @Html.PagedListPager(Model, page => Url.Action("Index", "Users", new { page = page }))
    </div>
</div>
<script src="~/Scripts/Delete.js"></script>
<style>
    .MenuTrang {
        margin-top: 500px;
        display: inline;
        text-align: center;
        width: 100%;
    }
</style>


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    const btnDelete = document.querySelectorAll('.delete');

    btnDelete.forEach(btn => {
        btn.addEventListener('click', (event) => {
            var id = btn.dataset.id;
            event.preventDefault();

            Swal.fire({
                title: 'Bạn có chắc chắn muốn xóa ?',
                text: "Nếu bạn xóa bạn không thể khôi phục lại!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes !'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire(
                        'Xóa thành công'
                    )
                    window.location.href = "/Users/Delete/" + id;
                }
            })
        });
    });
</script>